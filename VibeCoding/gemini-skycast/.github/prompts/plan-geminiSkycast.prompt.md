# 📋 Gemini SkyCast 7日天氣預報APP - 完整規劃文檔

## **項目概述**
Gemini SkyCast 是一個基於 Google Gemini 2.5 Flash AI 的智能天氣預報應用。當前實現了單日天氣查詢功能，需要擴展為**完整的7天天氣預報系統**。

---

## **現狀評估**

✅ **已完成**
- 城市搜索和查詢功能
- 當前天氣即時顯示（溫度、濕度、風速、條件）
- AI 生成的中文天氣分析報告
- Google Search Grounding 數據來源追蹤
- 響應式設計和美觀的 UI

❌ **缺失的核心功能**
- 7日完整天氣預報卡片展示
- 預報數據的結構化存儲
- 地區快速選擇功能
- 搜索歷史記錄

---

## **技術棧**
- **前端**：React 19 + TypeScript 5.8
- **構建**：Vite 6.2
- **樣式**：Tailwind CSS
- **AI**：Google Gemini 2.5 Flash + Search Grounding
- **圖標**：Lucide React

---

## **規劃方案**

### **第一階段：數據模型擴展**
1. 擴展 `types.ts`：
   - 新增 `ForecastDay` 接口（日期、高溫、低溫、狀況、圖標、降雨機率）
   - 改進 `WeatherData` 為支持7天數據的結構

2. 優化 `geminiService.ts`：
   - 改進 Prompt 要求 Gemini 返回結構化的7日預報 JSON 數據
   - 實現解析 7 天預報數據的邏輯

### **第二階段：UI 組件開發**
1. 創建 `ForecastCard.tsx` 組件：
   - 7 個預報卡片（每天一個）
   - 顯示日期、高低溫、天氣狀況、圖標
   - 可選：水平滑動或網格展示

2. 改進 `WeatherCard.tsx`：
   - 分離今日天氣為獨立卡片
   - 整合 7 日預報卡片展示

3. 優化 `App.tsx`：
   - 管理 7 日預報狀態
   - 完整的搜索和加載流程

### **第三階段：用戶體驗增強**
1. 實現地區預設選項：
   - 常見城市快選按鈕（台北、台中、台南等）
   - 快速切換城市

2. 添加搜索歷史：
   - LocalStorage 保存最近 5 個搜索記錄
   - 快速重新查詢

3. 改進視覺反饋：
   - 骨架屏加載狀態
   - 動畫過渡效果

### **第四階段：可選增強功能**
1. 地理定位：根據用戶位置自動查詢
2. 深色模式：系統主題支持
3. 詳細預報：點擊卡片查看當日詳細信息
4. 分享功能：分享天氣預報截圖

---

## **開發優先級建議**

| 優先級 | 功能 | 預計工作量 |
|------|------|---------|
| 🔴 P1 | 7日預報數據模型 + Prompt 優化 | 2-3 天 |
| 🔴 P1 | ForecastCard 組件開發 | 1-2 天 |
| 🟡 P2 | 地區快選功能 | 0.5-1 天 |
| 🟡 P2 | 搜索歷史記錄 | 1 天 |
| 🟢 P3 | 深色模式 + 分享功能 | 1-2 天 |

---

## **實現建議**

### **Prompt 工程建議**
當前 Prompt 應改進為返回結構化7日預報，例如：
```json
{
  "today": { "temp": "23°C", "condition": "晴朗", ... },
  "forecast": [
    { "date": "12/29", "high": "25", "low": "18", "condition": "多雲", ... },
    ...
  ]
}
```

### **文件結構建議**
```
components/
  ├── WeatherCard.tsx      # 今日天氣卡片
  ├── ForecastCard.tsx     # 預報卡片組件（新）
  └── ForecastGrid.tsx     # 預報列表容器（新）
```

### **LocalStorage 方案**
```typescript
// 保存搜索歷史
localStorage.setItem('weatherHistory', JSON.stringify(searchHistory))
```

---

## **風險與注意事項**

⚠️ **API 成本**：Gemini 2.5 Flash 按調用次數計費，頻繁查詢會增加成本
- **建議**：實現查詢去重和緩存機制

⚠️ **數據可靠性**：Google Search Grounding 依賴實時網絡
- **建議**：添加離線降級方案和錯誤重試

⚠️ **API Key 安全**：當前 API Key 存儲在前端
- **建議**：未來考慮後端中轉

---

## **下一步行動**

1. [ ] 審核並確認規劃方案
2. [ ] 開始第一階段：擴展數據模型
3. [ ] 實現新的 Prompt 工程
4. [ ] 開發預報卡片組件
5. [ ] 測試7日預報功能
6. [ ] 實現地區快選和搜索歷史
7. [ ] 整體功能測試和優化

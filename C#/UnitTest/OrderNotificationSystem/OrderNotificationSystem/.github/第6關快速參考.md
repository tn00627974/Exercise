# 第 6 關快速參考

## 1分鐘核心

裝飾器模式 = 不修改原有代碼，動態添加功能

```csharp
// 不好
public class EmailSender {
    // 原有邏輯 + 日誌 + 重試 + 超時 = 混亂！
}

// 好
var sender = new EmailSender();
var withLog = new LoggingDecorator(sender);
var withRetry = new RetryDecorator(withLog);
var withTimeout = new TimeoutDecorator(withRetry);
```

---

## 建立步驟

### Step 1: 建立資料夾
```
OrderNotificationSystem/Decorators/
OrderNotificationSystemTests/Unit/Decorators/
```

### Step 2: 複製檔案
3 個裝飾器 + 3 個測試 = 6 個檔案
(詳見「第6關完整代碼.md」)

### Step 3: 執行測試
```bash
dotnet test
```

結果應該是：10 tests passed, 0 failed ?

---

## 3個裝飾器速記

| 名稱 | 功能 | 代碼量 |
|------|------|--------|
| Logging | 記錄日誌 | ~50行 |
| Retry | 失敗重試 | ~70行 |
| Timeout | 超時控制 | ~60行 |

---

## 裝飾器核心樣版

```csharp
public class MyDecorator : INotificationSender
{
    private readonly INotificationSender _inner;

    public MyDecorator(INotificationSender inner)
    {
        _inner = inner ?? throw new ArgumentNullException(nameof(inner));
    }

    public NotificationResult Send(Order order)
    {
        // 前置邏輯
        var result = _inner.Send(order);
        // 後置邏輯
        return result;
    }
}
```

---

## 常見錯誤

? 忘記 null check  
? 忘記呼叫 _inner.Send()  
? 命名空間不對  

---

## 驗證成功

```bash
$ dotnet test
...
Total: 10
Passed: 10 ?
```

完成！??

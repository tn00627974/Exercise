
---

# ä¸€ã€ç·´ç¿’å°ˆæ¡ˆä¸»é¡Œï¼ˆç°¡å–®åˆçœŸå¯¦ï¼‰

**DI / interface / NUnit æœƒä¸€æ¬¡å…¨éƒ¨æ‰“é€š**ã€‚

1ï¸âƒ£ ç·´ç¿’å°ˆæ¡ˆçš„ã€Œæ•…äº‹èƒŒæ™¯ã€  
2ï¸âƒ£ å°ˆæ¡ˆçµæ§‹  
3ï¸âƒ£ å®Œæ•´ç¨‹å¼ç¢¼ï¼ˆå¯ç›´æ¥å»ºç«‹ï¼‰  
4ï¸âƒ£ ç·´ç¿’æ­¥é©Ÿï¼ˆä½ ç…§é †åºåšï¼‰

ä¸æœƒç”¨ ASP.NETã€ä¸ç”¨å®¹å™¨ï¼Œ**å…ˆç”¨æœ€ç´”çš„ DI æ€ç¶­**ã€‚

## ğŸ¯ ä¸»é¡Œï¼š**è¨‚å–®é€šçŸ¥ç³»çµ±**

éœ€æ±‚åªæœ‰ä¸€å¥è©±ï¼š

> ä¸‹è¨‚å–®å¾Œï¼Œç³»çµ±è¦ã€Œç™¼é€é€šçŸ¥ã€

é€šçŸ¥æ–¹å¼æœªä¾†å¯èƒ½æœ‰ï¼š

- Email    
- Line    
- ç°¡è¨Š    

ğŸ‘‰ **é€™éå¸¸é©åˆç·´ interface + DI + NUnit**

---

# äºŒã€å°ˆæ¡ˆçµæ§‹ï¼ˆç…§é€™å€‹å»ºï¼‰

å»ºç«‹ä¸€å€‹ **Solution**

```
OrderNotificationDemo
â”‚
â”œâ”€ OrderNotification.Core
â”‚   â”œâ”€ INotificationSender.cs
â”‚   â”œâ”€ Order.cs
â”‚   â”œâ”€ NotificationResult.cs
â”‚   â”œâ”€ EmailNotificationSender.cs
â”‚   â””â”€ OrderService.cs
â”‚
â””â”€ OrderNotification.Tests
    â”œâ”€ FakeNotificationSender.cs
    â””â”€ OrderServiceTests.cs
```

---

# ä¸‰ã€æ­£å¼ç¨‹å¼ç¢¼ï¼ˆCoreï¼‰

## 1ï¸âƒ£ INotificationSender.csï¼ˆä»‹é¢ï¼‰

```csharp
public interface INotificationSender
{
    NotificationResult Send(Order order);
}
```

---

## 2ï¸âƒ£ Order.csï¼ˆDTOï¼‰

```csharp
public class Order
{
    public string OrderNo { get; set; }
    public decimal Amount { get; set; }
}
```

---

## 3ï¸âƒ£ NotificationResult.cs

```csharp
public class NotificationResult
{
    public bool Success { get; set; }
    public string Message { get; set; }
}
```

---

## 4ï¸âƒ£ EmailNotificationSender.csï¼ˆçœŸå¯¦å¯¦ä½œï¼‰

```csharp
public class EmailNotificationSender : INotificationSender
{
    public NotificationResult Send(Order order)
    {
        // å‡è£åœ¨å¯„ Email
        return new NotificationResult
        {
            Success = true,
            Message = $"Email å·²å¯„å‡ºï¼Œè¨‚å–®ï¼š{order.OrderNo}"
        };
    }
}
```

---

## 5ï¸âƒ£ OrderService.csï¼ˆâ­ é‡é»ï¼‰

```csharp
public class OrderService
{
    private readonly INotificationSender _sender;

    // ğŸ‘‰ DIï¼šå¾å¤–é¢æ³¨å…¥
    public OrderService(INotificationSender sender)
    {
        _sender = sender;
    }

    public NotificationResult PlaceOrder(Order order)
    {
        if (order.Amount <= 0)
        {
            return new NotificationResult
            {
                Success = false,
                Message = "è¨‚å–®é‡‘é¡éŒ¯èª¤"
            };
        }

        return _sender.Send(order);
    }
}
```

ğŸ“Œ **é€™å€‹ class æ˜¯ä½ æ¸¬è©¦çš„æ ¸å¿ƒ**

---

# å››ã€æ¸¬è©¦ç¨‹å¼ç¢¼ï¼ˆNUnitï¼‰

## 6ï¸âƒ£ FakeNotificationSender.csï¼ˆå‡å¯¦ä½œï¼‰

```csharp
public class FakeNotificationSender : INotificationSender
{
    public NotificationResult Send(Order order)
    {
        return new NotificationResult
        {
            Success = true,
            Message = "Fake é€šçŸ¥æˆåŠŸ"
        };
    }
}
```

---

## 7ï¸âƒ£ OrderServiceTests.cs

```csharp
using NUnit.Framework;

[TestFixture]
public class OrderServiceTests
{
    [Test]
    public void PlaceOrder_ValidAmount_ShouldSendNotification()
    {
        // Arrange
        var sender = new FakeNotificationSender();
        var service = new OrderService(sender);

        var order = new Order
        {
            OrderNo = "ORD001",
            Amount = 1000
        };

        // Act
        var result = service.PlaceOrder(order);

        // Assert
        Assert.IsTrue(result.Success);
        Assert.AreEqual("Fake é€šçŸ¥æˆåŠŸ", result.Message);
    }

    [Test]
    public void PlaceOrder_InvalidAmount_ShouldFail()
    {
        // Arrange
        var sender = new FakeNotificationSender();
        var service = new OrderService(sender);

        var order = new Order
        {
            OrderNo = "ORD002",
            Amount = 0
        };

        // Act
        var result = service.PlaceOrder(order);

        // Assert
        Assert.IsFalse(result.Success);
        Assert.AreEqual("è¨‚å–®é‡‘é¡éŒ¯èª¤", result.Message);
    }
}
```

---

# äº”ã€ä½ ç¾åœ¨ã€Œå¯¦éš›å­¸åˆ°ã€çš„æ˜¯ä»€éº¼ï¼Ÿ

### âœ… Interface

- `INotificationSender` æ˜¯åˆç´„
    
- Email / Fake éƒ½å¯ä»¥æ›¿æ›
    

### âœ… DIï¼ˆå»ºæ§‹å¼æ³¨å…¥ï¼‰

- `OrderService` **ä¸è‡ªå·± new**
    
- å¤–é¢æ±ºå®šè¦ç”¨èª°
    

### âœ… NUnit

- ä¸é€£å¤–    
- ä¸é  UI    
- æ¸¬çš„æ˜¯ã€Œè¡Œç‚ºã€
    

---

# å…­ã€å»ºè­°ä½ ç…§é€™å€‹é †åºç·´ï¼ˆå¾ˆé‡è¦ï¼‰

### ğŸ” ç¬¬ 1 é—œï¼ˆç¾åœ¨ï¼‰

âœ” è·‘éæ¸¬è©¦  
âœ” ç¢ºå®šå…¨éƒ¨ç¶ ç‡ˆ

---

### ğŸ” ç¬¬ 2 é—œï¼ˆä½ è‡ªå·±æ”¹ï¼‰

- æ–°å¢ `LineNotificationSender`
    
- ä¸æ”¹ `OrderService`
    
- æ¸¬è©¦ä»ç„¶è¦é
    

---

### ğŸ” ç¬¬ 3 é—œï¼ˆé€²éšï¼‰

- è®“ `FakeNotificationSender` å¯ä»¥ã€ŒæŒ‡å®šæˆåŠŸæˆ–å¤±æ•—ã€    
- æ¸¬å¤±æ•—æƒ…å¢ƒ
    
---

### ğŸ” ç¬¬ 4 é—œï¼ˆé€²éš - ä¾è³´æ³¨å…¥æ·±åŒ–ï¼‰

- æ–°å¢ `IOrderValidator` ä»‹é¢
    
- `OrderService` åŒæ™‚æ³¨å…¥ã€Œé©—è­‰å™¨ã€å’Œã€Œé€šçŸ¥ç™¼é€å™¨ã€
    
- é©—è­‰å¤±æ•—æ™‚ï¼Œä¸å‘¼å« `Send()`
    
- ç”¨ `Substitute` Mock é©—è­‰ `Send()` å‘¼å«æ¬¡æ•¸

**é‡é»å­¸ç¿’ï¼š**
- âœ… å¤šå€‹ä»‹é¢ä¾è³´æ³¨å…¥
- âœ… é—œæ³¨é»åˆ†é›¢ï¼ˆValidation vs Notificationï¼‰
- âœ… Mock é©—è­‰æ–¹æ³•å‘¼å«ï¼ˆ`Received()` / `DidNotReceive()`ï¼‰

---

### ğŸ” ç¬¬ 5 é—œï¼ˆé€²éš - çœŸå¯¦å ´æ™¯ï¼šComposite Patternï¼‰

#### ğŸ“‹ æ–°éœ€æ±‚

è¨‚å–®ä¸‹å–®å¾Œï¼Œæœ‰æ™‚å€™éœ€è¦ã€ŒåŒæ™‚ç™¼é€å¤šå€‹é€šçŸ¥ã€

ä¾‹å¦‚ï¼šåŒæ™‚å¯„ Email **å’Œ** ç™¼é€ Line

#### ğŸ¯ å ´æ™¯æ¡ˆä¾‹

```csharp
// â“ ç¾åœ¨æ€éº¼åŒæ™‚ç”¨é€™å…©å€‹ï¼Ÿ
// OrderService åªèƒ½æ³¨å…¥ä¸€å€‹ INotificationSender...

var emailSender = new EmailNotificationSender();
var lineSender = new LineNotificationSender();

// éœ€è¦åŒæ™‚ç™¼é€ Email å’Œ Line
```

#### ğŸ’¡ è§£æ±ºæ–¹æ¡ˆï¼šComposite Pattern

**å»ºç«‹è¤‡åˆé€šçŸ¥ç™¼é€å™¨ï¼š**

```csharp
// OrderNotificationSystem\CompositeNotificationSender.cs
using System;
using System.Collections.Generic;
using System.Linq;

namespace OrderNotificationSystem
{
    /// <summary>
    /// è¤‡åˆé€šçŸ¥ç™¼é€å™¨ï¼šåŒæ™‚ä½¿ç”¨å¤šå€‹ç™¼é€å™¨
    /// </summary>
    public class CompositeNotificationSender : INotificationSender
    {
        private readonly IEnumerable<INotificationSender> _senders;

        public CompositeNotificationSender(params INotificationSender[] senders)
        {
            _senders = senders;
        }

        public NotificationResult Send(Order order)
        {
            var results = new List<NotificationResult>();
            var failedMessages = new List<string>();

            // é€ä¸€åŸ·è¡Œæ‰€æœ‰ç™¼é€å™¨
            foreach (var sender in _senders)
            {
                try
                {
                    var result = sender.Send(order);
                    results.Add(result);

                    if (!result.Success)
                    {
                        failedMessages.Add(result.Message);
                    }
                }
                catch (Exception ex)
                {
                    failedMessages.Add($"ç™¼é€å¤±æ•—: {ex.Message}");
                }
            }

            // æ±ºå®šæ•´é«”çµæœ
            if (failedMessages.Any())
            {
                return new NotificationResult
                {
                    Success = false,
                    Message = $"éƒ¨åˆ†é€šçŸ¥å¤±æ•—: {string.Join("; ", failedMessages)}"
                };
            }

            return new NotificationResult
            {
                Success = true,
                Message = $"æ‰€æœ‰é€šçŸ¥å·²ç™¼é€ ({results.Count} å€‹)"
            };
        }
    }
}
```

#### ğŸ§ª æ¸¬è©¦æ¡ˆä¾‹

```csharp
// OrderNotificationSystemTests\CompositeNotificationSenderTests.cs
using NSubstitute;
using OrderNotificationSystem;
using OrderNotificationSystem.Models;

namespace OrderNotificationSystemTests
{
    public class CompositeNotificationSenderTests
    {
        [Test]
        public void Send_WithMultipleSenders_AllSuccess()
        {
            // Arrange
            var order = new Order { OrderNo = "ORD001", Amount = 1000 };
            
            var emailSender = Substitute.For<INotificationSender>();
            var lineSender = Substitute.For<INotificationSender>();
            
            emailSender.Send(Arg.Any<Order>()).Returns(new NotificationResult 
            { 
                Success = true, 
                Message = "Email sent" 
            });
            
            lineSender.Send(Arg.Any<Order>()).Returns(new NotificationResult 
            { 
                Success = true, 
                Message = "Line sent" 
            });

            var composite = new CompositeNotificationSender(emailSender, lineSender);

            // Act
            var result = composite.Send(order);

            // Assert
            Assert.That(result.Success, Is.True);
            Assert.That(result.Message, Contains.Substring("2"));
            
            // ğŸ‘‰ é©—è­‰å…©å€‹ç™¼é€å™¨éƒ½è¢«å‘¼å«
            emailSender.Received(1).Send(order);
            lineSender.Received(1).Send(order);
        }

        [Test]
        public void Send_WhenOneSenderFails_ReturnsFailure()
        {
            // Arrange
            var order = new Order { OrderNo = "ORD002", Amount = 500 };
            
            var emailSender = Substitute.For<INotificationSender>();
            var lineSender = Substitute.For<INotificationSender>();
            
            emailSender.Send(Arg.Any<Order>()).Returns(new NotificationResult 
            { 
                Success = true, 
                Message = "Email sent" 
            });
            
            lineSender.Send(Arg.Any<Order>()).Returns(new NotificationResult 
            { 
                Success = false, 
                Message = "Line service down" 
            });

            var composite = new CompositeNotificationSender(emailSender, lineSender);

            // Act
            var result = composite.Send(order);

            // Assert
            Assert.That(result.Success, Is.False);
            Assert.That(result.Message, Contains.Substring("Line service down"));
        }

        [Test]
        public void Send_WithRealSenders_EmailAndLine()
        {
            // Arrange - æ•´åˆæ¸¬è©¦ï¼šä½¿ç”¨çœŸå¯¦å¯¦ä½œ
            var order = new Order { OrderNo = "ORD003", Amount = 1500 };
            
            INotificationSender emailSender = new EmailNotificationSender();
            INotificationSender lineSender = new LineNotificationSender();
            
            var composite = new CompositeNotificationSender(emailSender, lineSender);

            // Act
            var result = composite.Send(order);

            // Assert
            Assert.That(result.Success, Is.True);
            Assert.That(result.Message, Contains.Substring("æ‰€æœ‰é€šçŸ¥å·²ç™¼é€"));
        }
    }
}
```

#### ğŸ¯ ç”¨æ³•ç¤ºä¾‹

**åŸä¾†ï¼ˆåªèƒ½ä¸€å€‹ï¼‰ï¼š**
```csharp
INotificationSender sender = new EmailNotificationSender();
var orderService = new OrderService(_validator, sender);
```

**ç¾åœ¨ï¼ˆå¯ä»¥å¤šå€‹ï¼‰ï¼š**
```csharp
// åŒæ™‚ç™¼é€ Email å’Œ Line
INotificationSender composite = new CompositeNotificationSender(
    new EmailNotificationSender(),
    new LineNotificationSender()
);
var orderService = new OrderService(_validator, composite);
```

#### ğŸ“š ä½ å­¸åˆ°çš„æ–°æ¦‚å¿µ

### âœ… **Composite Patternï¼ˆçµ„åˆæ¨¡å¼ï¼‰**
- `CompositeNotificationSender` æœ¬èº«ä¹Ÿæ˜¯ `INotificationSender`
- å¯ä»¥åŒ…å«å¤šå€‹ `INotificationSender`
- å°å¤–è¡¨ç¾è·Ÿå–®ä¸€ç™¼é€å™¨ä¸€æ¨£ï¼ˆé€æ˜æ€§ï¼‰
- å¯ä»¥ç„¡é™çµ„åˆåµŒå¥—

### âœ… **Exception Handlingï¼ˆç•°å¸¸è™•ç†ï¼‰**
- éƒ¨åˆ†å¤±æ•—ä¸æœƒå°è‡´å…¨éƒ¨å¤±æ•—
- è¨˜éŒ„æ¯å€‹å¤±æ•—çš„åŸå› 
- ä½¿ç”¨ try-catch æ•æ‰ç•°å¸¸

### âœ… **Collectionsï¼ˆé›†åˆï¼‰**
- ä½¿ç”¨ `IEnumerable<T>` å­˜æ”¾å¤šå€‹ä¾è³´
- ä½¿ç”¨ `params` ç°¡åŒ–å»ºæ§‹å­
- ä½¿ç”¨ `Linq` æŸ¥è©¢é›†åˆ

**é‡é»å­¸ç¿’ï¼š**
- âœ… è¨­è¨ˆæ¨¡å¼ï¼šComposite Pattern
- âœ… ç•°å¸¸è™•ç†å’Œå®¹éŒ¯
- âœ… é›†åˆæ“ä½œå’Œè¿´åœˆ

---

# ä¸ƒã€ä¸€å¥æ–°æ‰‹ä¸€å®šè¦è¨˜ä½çš„è©±

> **ã€Œæˆ‘èƒ½ç”¨ Fake æ¸¬è©¦ï¼Œä»£è¡¨æˆ‘æ¶æ§‹æ˜¯å°çš„ã€**

---

# å…«ã€é€²éšä¼æ¥­ç”¨æ³•ï¼ˆé¸ä¿®ï¼‰â­â­â­

ç•¶ä½ å®Œæˆç¬¬é—œå¡å¾Œï¼Œå¯ä»¥å­¸ç¿’ä¼æ¥­æ¨™æº–çš„åšæ³•ã€‚

## ä¼æ¥­æ¨™æº–çš„æ¸¬è©¦çµ„ç¹”æ–¹å¼

### ğŸ“ æ¨è–¦çš„å°ˆæ¡ˆçµæ§‹

```
OrderNotificationSystem/
â”œâ”€ Core/
â”‚   â”œâ”€ INotificationSender.cs
â”‚   â”œâ”€ IOrderValidator.cs
â”‚   â”œâ”€ Order.cs
â”‚   â”œâ”€ NotificationResult.cs
â”‚   â”œâ”€ EmailNotificationSender.cs
â”‚   â”œâ”€ LineNotificationSender.cs
â”‚   â”œâ”€ DefaultOrderValidator.cs
â”‚   â””â”€ OrderService.cs
â”‚
â””â”€ Tests/
    â”œâ”€ Unit/                           # ğŸ‘ˆ å–®å…ƒæ¸¬è©¦è³‡æ–™å¤¾
    â”‚   â”œâ”€ OrderServiceTests.cs
    â”‚   â”œâ”€ DefaultOrderValidatorTests.cs
    â”‚   â””â”€ FakeNotificationSenderTests.cs
    â”‚
    â””â”€ Integration/                    # ğŸ‘ˆ æ•´åˆæ¸¬è©¦è³‡æ–™å¤¾
        â””â”€ OrderServiceIntegrationTests.cs
```

### ğŸ“Š ç‚ºä»€éº¼è¦åˆ†é–‹ï¼Ÿ

| é …ç›® | å–®å…ƒæ¸¬è©¦ | æ•´åˆæ¸¬è©¦ |
|------|---------|---------|
| **æª”æ¡ˆä½ç½®** | `Tests/Unit/` | `Tests/Integration/` |
| **ä½¿ç”¨ Mock** | âœ… Substitute | âŒ ä¸ç”¨ |
| **ä½¿ç”¨çœŸå¯¦é¡** | âŒ éš”é›¢ | âœ… çœŸå¯¦å¯¦ä½œ |
| **åŸ·è¡Œé€Ÿåº¦** | âš¡ å¿«ï¼ˆç§’ç´šï¼‰ | ğŸŒ æ…¢ï¼ˆåˆ†é˜ç´šï¼‰ |
| **åŸ·è¡Œæ™‚æ©Ÿ** | æ¯æ¬¡å­˜æª” | å®šæœŸ/æäº¤å‰ |
| **è¦†è“‹ç¯„åœ** | å–®ä¸€é¡åˆ¥/æ–¹æ³• | å¤šå€‹é¡åˆ¥å”ä½œ |

### âœ… å–®å…ƒæ¸¬è©¦ç¯„ä¾‹ï¼šOrderServiceTests.cs

```csharp
using NSubstitute;
using OrderNotificationSystem.Models;
using OrderNotificationSystem;

namespace OrderNotificationSystemTests.Unit
{
    public class OrderServiceTests
    {
        private INotificationSender _mockSender;
        private IOrderValidator _mockValidator;

        [SetUp]
        public void Setup()
        {
            _mockSender = Substitute.For<INotificationSender>();
            _mockValidator = Substitute.For<IOrderValidator>();
        }

        [Test]
        public void PlaceOrder_When_ValidatorPasses_ShouldCallSender()
        {
            // Arrange - ç”¨ Mock éš”é›¢ä¾è³´
            var order = new Order { OrderNo = "order001", Amount = 100 };
            _mockValidator.Validate(Arg.Any<Order>()).Returns(new NotificationResult 
            { 
                Success = true, 
                Message = "é©—è­‰é€šé" 
            });

            var orderService = new OrderService(_mockValidator, _mockSender);

            // Act
            var result = orderService.PlaceOrder(order);

            // Assert
            Assert.That(result.Success, Is.True);
            
            // ğŸ‘‰ é©—è­‰è¡Œç‚ºï¼šSend è¢«å‘¼å« 1 æ¬¡
            _mockSender.Received(1).Send(order);
        }

        [Test]
        public void PlaceOrder_When_ValidatorFails_ShouldNotCallSender()
        {
            // Arrange - é©—è­‰å¤±æ•—çš„æƒ…æ³
            var order = new Order { OrderNo = "order001", Amount = -100 };
            _mockValidator.Validate(Arg.Any<Order>()).Returns(new NotificationResult 
            { 
                Success = false, 
                Message = "è¨‚å–®éŒ¯èª¤" 
            });

            var orderService = new OrderService(_mockValidator, _mockSender);

            // Act
            var result = orderService.PlaceOrder(order);

            // Assert
            Assert.That(result.Success, Is.False);
            
            // ğŸ‘‰ é©—è­‰è¡Œç‚ºï¼šSend æ²’æœ‰è¢«å‘¼å«
            _mockSender.DidNotReceive().Send(Arg.Any<Order>());
        }
    }
}
```

### âœ… æ•´åˆæ¸¬è©¦ç¯„ä¾‹ï¼šOrderServiceIntegrationTests.cs

```csharp
using OrderNotificationSystem.Models;
using OrderNotificationSystem;

namespace OrderNotificationSystemTests.Integration
{
    public class OrderServiceIntegrationTests
    {
        [Test]
        public void PlaceOrder_WithRealValidator_AndRealEmailSender_CompleteFlow()
        {
            // Arrange - ä½¿ç”¨çœŸå¯¦å¯¦ä½œï¼Œä¸ç”¨ Mock
            var order = new Order { OrderNo = "ORD-2024-001", Amount = 1000 };
            IOrderValidator validator = new DefaultOrderValidator();
            INotificationSender sender = new EmailNotificationSender();
            var orderService = new OrderService(validator, sender);

            // Act - åŸ·è¡Œå®Œæ•´æµç¨‹
            var result = orderService.PlaceOrder(order);

            // Assert - é©—è­‰ç«¯å°ç«¯æµç¨‹
            Assert.That(result.Success, Is.True);
            Assert.That(result.Message, Is.EqualTo($"è¨‚å–®é‡‘é¡ç‚º{order.Amount}å…ƒ"));
        }

        [Test]
        public void PlaceOrder_WithRealValidator_AndRealLineSender_CompleteFlow()
        {
            // Arrange - ä½¿ç”¨çœŸå¯¦å¯¦ä½œæ¸¬è©¦ä¸åŒç™¼é€è€…
            var order = new Order { OrderNo = "ORD-2024-002", Amount = 500 };
            IOrderValidator validator = new DefaultOrderValidator();
            INotificationSender sender = new LineNotificationSender();
            var orderService = new OrderService(validator, sender);

            // Act
            var result = orderService.PlaceOrder(order);

            // Assert
            Assert.That(result.Success, Is.True);
            Assert.That(result.Message, Is.EqualTo($"è¨‚å–®é‡‘é¡ç‚º{order.Amount}å…ƒ"));
        }

        [Test]
        public void PlaceOrder_WithInvalidAmount_FailsValidation()
        {
            // Arrange - æ•´åˆæ¸¬è©¦é©—è­‰æµç¨‹ï¼šé©—è­‰å¤±æ•— â†’ ä¸ç™¼é€
            var order = new Order { OrderNo = "ORD-2024-003", Amount = -100 };
            IOrderValidator validator = new DefaultOrderValidator();
            INotificationSender sender = new EmailNotificationSender();
            var orderService = new OrderService(validator, sender);

            // Act
            var result = orderService.PlaceOrder(order);

            // Assert - é©—è­‰æ•´å€‹æµç¨‹çš„è¡Œç‚º
            Assert.That(result.Success, Is.False);
            Assert.That(result.Message, Is.EqualTo("è¨‚å–®éŒ¯èª¤"));
        }
    }
}
```

### ğŸ¯ æ¸¬è©¦é‡‘å­—å¡”

```
        ğŸ“Š E2E æ¸¬è©¦
       /            \
      å°‘é‡         (1å€‹)
     /                  \
    æ•´åˆæ¸¬è©¦           (å°‘é‡)
   /                      \
  å–®å…ƒæ¸¬è©¦              (å¤§é‡ â­)
 /____________________________\

æ¯”ä¾‹ï¼š
- å–®å…ƒæ¸¬è©¦ 80%  â†’ å¿«é€Ÿåé¥‹ï¼Œæ¯æ¬¡å­˜æª”åŸ·è¡Œ
- æ•´åˆæ¸¬è©¦ 15%  â†’ é©—è­‰å”ä½œï¼Œæäº¤å‰åŸ·è¡Œ
- E2E æ¸¬è©¦ 5%   â†’ å®Œæ•´æµç¨‹ï¼Œéƒ¨ç½²å‰åŸ·è¡Œ
```

### âœ¨ ä¼æ¥­åšæ³•å„ªå‹¢

âœ… **å¿«é€Ÿé–‹ç™¼**
- åªåŸ·è¡Œå–®å…ƒæ¸¬è©¦ï¼šç§’ç´šåé¥‹
- ç«‹å³ç™¼ç¾é‚è¼¯å•é¡Œ

âœ… **å¯é éƒ¨ç½²**
- å–®å…ƒæ¸¬è©¦ âœ“ + æ•´åˆæ¸¬è©¦ âœ“ = é«˜ä¿¡å¿ƒ
- æ¸…æ¥šçŸ¥é“å•é¡Œåœ¨å“ªä¸€å±¤

âœ… **æ˜“æ–¼ç¶­è­·**
- æ¸¬è©¦è·è²¬æ¸…æ™°
- æ¯å€‹è³‡æ–™å¤¾ä¸€å€‹ç›®çš„

âœ… **æŒçºŒæ•´åˆ**
- CI/CD å¯åˆ†éšæ®µåŸ·è¡Œ
- å¿«é€Ÿå¤±æ•—ï¼ˆfail fastï¼‰

### ğŸš€ å¦‚ä½•å¯¦æ–½

1. **å»ºç«‹è³‡æ–™å¤¾çµæ§‹**
   ```
   Tests/
   â”œâ”€â”€ Unit/
   â””â”€â”€ Integration/
   ```

2. **é·ç§»ç¾æœ‰æ¸¬è©¦**
   - Mock çš„ â†’ `Unit/`
   - çœŸå¯¦å¯¦ä½œ â†’ `Integration/`

3. **è¨­å®šæ¸¬è©¦åŸ·è¡Œ**
   ```bash
   # å¿«é€Ÿåé¥‹ï¼ˆé–‹ç™¼ä¸­ï¼‰
   dotnet test --filter "Category=Unit"
   
   # å®Œæ•´æ¸¬è©¦ï¼ˆæäº¤å‰ï¼‰
   dotnet test
   ```

4. **åœ¨ CI/CD ä¸­ä½¿ç”¨**
   ```yaml
   # é–‹ç™¼éšæ®µï¼šåªè·‘å–®å…ƒæ¸¬è©¦ï¼ˆå¿«ï¼‰
   jobs:
     - script: dotnet test --filter "Category=Unit"
   
   # éƒ¨ç½²å‰ï¼šè·‘å…¨éƒ¨æ¸¬è©¦ï¼ˆå®Œæ•´ï¼‰
     - script: dotnet test
   ```

---

å¦‚æœä½ é¡˜æ„ï¼Œä¸‹ä¸€æ­¥æˆ‘å¯ä»¥ç›´æ¥å‡ºã€Œä½œæ¥­é¡Œã€çµ¦ä½ ï¼Œä¾‹å¦‚ï¼š

- â“ å“ªå€‹åœ°æ–¹ã€Œä¸è©²æŠ½ä»‹é¢ã€    
- ğŸ§ª è«‹ä½ è£œä¸€å€‹æ¸¬è©¦ï¼ˆæˆ‘å¹«ä½ æ”¹ï¼‰    
- ğŸ’£ æˆ‘æ•…æ„å¯«ä¸€å€‹å£ç‰ˆæœ¬ï¼Œè®“ä½ ä¿®
    

ä½ åªè¦èªªï¼š  
ğŸ‘‰ã€Œ**çµ¦æˆ‘ä¸‹ä¸€é—œ**ã€
### Redis常用操作命令整理

## 操作String（字串）類型

####  1、SET 設置鍵值

要設置一個鍵值對，請使用SET命令。 例如，要將鍵「name」設置為值「ulysses」，可以執行以下操作：
```r
127.0.0.1:6379> SET name ulysses
# 1
```

####  2、GET 獲取鍵值

要獲取鍵值，請使用GET命令。 例如，要獲取鍵「name」的值，可以執行以下操作：
```r
127.0.0.1:6379> GET name
# ulysses
```

 這將返回鍵“name”的值，“ulysses”。


##### 將 Redis GET返 回時 以原始的方式來顯示內容  加上參數 --raw

```r
127.0.0.1:6379> SET name 最終幻想
# 1 
```

`1` 成功。

```r
127.0.0.1:6379> GET name 最終幻想
# "\xe6\x9c\x80\xe7\xb5\x82\xe5\xb9\xbb\xe6\x83\xb3" 中文被換成十六進制
```

`\x` : 為 十六進制

退出redis-cli
```r
127.0.0.1:6379> quit
# "\xe6\x9c\x80\xe7\xb5\x82\xe5\xb9\xbb\xe6\x83\xb3" 中文被換成十六進制
```

啟動redis 加上參數 --raw
```r
127.0.0.1:6379> redis-cli --raw
```

- 查詢 
```r
127.0.0.1:6379> GET gamename 
# 最終幻想 ✅正確
```

![](Pasted%20image%2020250929111453.png)

####  3、設置過期時間

 查看過期指定key的過期時間，可以用TTL命令。
```r
127.0.0.1:6379> TTL name
# -1 
```

`-1` : 代表沒有設置過期時間 

要為一個鍵設置過期時間，請使用EXPIRE命令。 例如，要將鍵「name」的過期時間設置為 **5** 秒，可以執行以下操作：
```r
127.0.0.1:6379> EXPIRE name 5
# 1 
```

 查看過期指定key的過期時間，可以用TTL命令。
```r
127.0.0.1:6379> TTL name
# 4 倒數中 ...
127.0.0.1:6379> TTL name
# 3 倒數中 ...
127.0.0.1:6379> TTL name
# 2 倒數中 ...
127.0.0.1:6379> TTL name
# 1 倒數中 ...
127.0.0.1:6379> TTL name
# -2 結束刪除 ...
```

返回的結果便是剩餘時間（到期key會自動刪除[目前先這麼認為，不同版本的不同角色處理有差異]），如果返回-1，則表示無過期時間

`-2`，說明key不存在。

鍵存在返回 `1`
鍵不存在返回`0`

####  4、三種方式可判斷鍵是否存在

![](Pasted%20image%2020250929114511.png)

##### 使用 EXISTS 指令

要檢查一個鍵是否存在，請使用EXISTS命令。 例如，要檢查鍵「name」是否存在，可以執行以下操作：
```r
127.0.0.1:6379> EXISTS name
# 0 
```

`0` : 不存在
##### 使用 TYPE 指令

```r
127.0.0.1:6379> TYPE name
# none 
```

`none` : 沒有這個類型，代表 key 不存在。

返回對應的類型（如，string）則說明key存在，返回“none”說明key不存在。

##### 使用 TTL 指令

```r
127.0.0.1:6379> TTL name
# -1 
```

####  5、刪除鍵

要刪除一個鍵，請使用DEL命令。 例如，要刪除鍵「name」，可以執行以下操作：
```r
127.0.0.1:6379> DEL aaa
```

####  6、自增/自減操作

要對一個鍵進行自增操作，請使用INCR命令。 例如，要將鍵「count」自增1，可以執行以下操作：

先 SET 設置 一個`count` 變數為 10 ( INT )  並使用 GET 查看內容
```r
127.0.0.1:6379> SET count 10
# OK 
127.0.0.1:6379> GET count 10
# 10
```

##### 使用 INCR命令

```r
127.0.0.1:6379> INCR count
# 11
127.0.0.1:6379> INCR count
# 12
127.0.0.1:6379> INCR count
# 13
```

##### 使用 DECR命令

類似地，要對一個鍵進行自減操作，請使用DECR命令，例如，要將鍵「count」自減1，可以執行以下操作：
```r
127.0.0.1:6379> DECR count
# 12
127.0.0.1:6379> DECR count
# 11
127.0.0.1:6379> DECR count
# 10
```

##### 使用 SETEX 指令

這個命令 是[[#1、SET 設置鍵值 | SET ]] + [[#使用 EXISTS 指令 | EXPIRE]] 的合體 

```r
127.0.0.1:6379> SETEX name 5 最終幻想
# OK
127.0.0.1:6379> TTL name 
# 4 倒數中..
# 3 倒數中..
# 2 倒數中..
# 1 倒數中..
# -2 結束刪除 ...
```
SETEX name 5 最終幻想 `設置 Key的值 name  + 5秒鐘 + value 的值

##### 使用 SETNX 指令

```r
127.0.0.1:6379> SETNX name 最終幻想
# OK
127.0.0.1:6379> SETNX name 最終幻想1
# 0
# 代表不能被修改，已經有name這個值
127.0.0.1:6379> GET name
# 最終幻想
```

---

##  操作哈希表（Hash類型）

Redis中的Hash類型是一個鍵值對的集合，其中每個鍵都映射到一個值。 下面是Redis中Hash類型的常見操作：

####  1、設置Hash值

要設置一個Hash值，請使用HSET命令。 例如，要將「person」哈希中的「name」字段設置為「ulysses」，age 「28 」可以執行以下操作：

```r
127.0.0.1:6379> HSET person name ulysses
# 1 
127.0.0.1:6379> HSET person age 28
# 1 
```

####  2、獲取Hash值

要獲取一個Hash值，請使用HGET命令。 例如，要獲取「person」哈希中的「name」字段的值，可以執行以下操作：

```r
127.0.0.1:6379> HGET person name
# ulysses
127.0.0.1:6379> HGET person age
# 28
```

####  3、獲取所有Hash值

要獲取所有的Hash值，請使用HGETALL命令。 例如，要獲取「person」哈希中所有的鍵值對，可以執行以下操作：

這將返回一個包含所有鍵值對的清單
```r
127.0.0.1:6379> HGETALL person
# name
# ulysses
# age
# 28
```

####  4、刪除Hash值

要刪除一個Hash值，請使用HDEL命令。 例如，要刪除「person」哈希中的age字段，可以執行以下操作：

```r
127.0.0.1:6379> HDEL person age
# 1

127.0.0.1:6379> HGETALL person
# name
# ulysses
# 會看到只剩下name 
```

####  5、檢查Hash值是否存在

要檢查一個Hash值是否存在，請使用HEXISTS命令。 例如，要檢查「person」哈希中是否存在「name」字段，可以執行以下操作：

```r
127.0.0.1:6379> HEXISTS person name
# 1
127.0.0.1:6379> HEXISTS person age
# 0
```

 如果存在，將返回1; 否則返回0。

####  6、獲取Hash中所有的鍵

要獲取一個Hash中所有的鍵，請使用HKEYS命令。 例如，要獲取「person」哈希中的所有鍵 KEY ，可以執行以下操作：

```r
127.0.0.1:6379> HKEYS person
# name
```

 這將返回一個包含所有鍵的清單。

####  7、獲取Hash中所有的值

要獲取一個Hash中所有的值，請使用HVALS命令。 例如，要獲取「person」哈希中的所有值 Value，可以執行以下操作：

```r
127.0.0.1:6379> HVALS person
# ulysses 
```

 這將返回一個包含所有值的清單。

---
##  操作清單（list類型）

Redis中的List類型是一個鏈表結構，其中每個節點都包含一個字元串值。 下面是Redis中List類型的常見操作：
創建一個新的list類型 : 可以使用  `LPUSH + key element` 、 `RPUSH + key element`  
####  1、在清單的頭部插入元素

使用 LPUSH 

請使用LPUSH命令在清單的頭部插入元素，例如，要在名為「mylist」的清單的頭部插入值為「b」的元素，可以執行以下操作：

```r
127.0.0.1:6379> LPUSH mylist b 
# 1 
127.0.0.1:6379> LPUSH mylist a # 從頭再添加 a
# 2
```

####  2、在清單的尾部插入元素

使用 LPUSH 

請使用RPUSH命令在清單的尾部插入元素， 例如，要在名為「mylist」的清單的尾部插入值為「c」的元素，可以執行以下操作：

```r
127.0.0.1:6379> RPUSH mylist c # 從尾巴添加 c 
# 3 
```

####  3、獲取清單長度

要獲取清單的長度，請使用LLEN命令。 例如，要獲取名為「mylist」的清單的長度，可以執行以下操作：

```r
127.0.0.1:6379> LLEN mylist
# 3
```

 這將返回清單的長度。

####  4、獲取清單中的單個元素

要獲取清單中的元素，請使用LINDEX命令。 例如，要獲取名為「mylist」的清單中的第一個元素，可以執行以下操作：

```r
127.0.0.1:6379> LINDEX mylist 0 # 取得第一個
# a
127.0.0.1:6379> LINDEX mylist 2 # 取得第三個
# c
```

####  5、獲取清單的範圍

要獲取清單的一部分，請使用LRANGE命令。 例如，要獲取名為「mylist」的清單中從第二個到第四個元素之間的元素，可以執行以下操作：

這將返回一個包含第一個到最後一個元素之間的所有元素的清單。
```r
127.0.0.1:6379> LRANGE mylist 0 -1 
# a
# b
# c
```

####  6、刪除清單中的元素

要刪除清單中的元素，請使用LREM命令。 例如，要刪除名為「mylist」的清單中的所有值為「ccc」的元素，可以執行以下操作：

```r
127.0.0.1:6379> LPUSH mylist a # 再添加一個 a
# 4
127.0.0.1:6379> LRANGE mylist 0 - 1
# a
# b 
# c
# a
127.0.0.1:6379> LREM mylist 0 a
# 2 
127.0.0.1:6379> LRANGE mylist 0 - 1
# b
# c
# 將a元素全都刪除

```
####  7、彈出清單中的元素
##### 使用 LPOP 命令
要從清單的頭部彈出元素，請使用LPOP命令。 例如，要從名為「mylist」的清單的頭部彈出一個元素，可以執行以下操作：

```r
127.0.0.1:6379> LPUSH mylist a # 從頭再添加一個 a
127.0.0.1:6379> RPUSH mylist d # 從尾再添加一個 d
127.0.0.1:6379> LRANGE mylist 0 -1 
# a 
# b 
# c
# d
127.0.0.1:6379> LPOP mylist # 將頭的a排除
# a # 這將彈出並返回清單的第一個元素。
```

##### 使用 RPOP命令
要從清單的尾部彈出元素，RPOP命令。 例如，要從名為「mylist」的清單的尾部彈出一個元素，可以執行以下操作：

```r
127.0.0.1:6379> LPOP mylist # 將頭的a排除
# d # 這將彈出並返回清單的第一個元素。
```

💡也可以使用 LPOP命令 和 RPOP命令 刪除多個內容 : 
```r
127.0.0.1:6379> LRANGE mylist 0 -1 
# a 
# b 
# c
# d
127.0.0.1:6379> LPOP mylist 2  # 將頭的兩個元素排除
# a
# b
127.0.0.1:6379> RPOP mylist 2  # 將尾的兩個元素排除
# c
# d
```

####  8、在指定清單內 前與後 加入新元素

##### 使用 LINSERT 命令 

範例 : 
```r 
LINSERT 列表 BEFORE|AFTER 元素

# BEFORE
LINSERT mylist BEFORE "第三位" "第二位"
# AFTER
LINSERT mylist AFTER "第三位" "第四位"
```

```r
127.0.0.1:6379> RPUSH mylist "第一位"
# 1

127.0.0.1:6379> RPUSH mylist "第三位"
# 2

127.0.0.1:6379> LRANGE mylist 0 -1
# 第一位
# 第三位


# 在 "第三位" 之前使用 BFEROE 插入元素 "第二位"
127.0.0.1:6379> LINSERT mylist BEFORE "第三位" "第二位"
# 3

127.0.0.1:6379> LRANGE mylist 0 -1
# 第一位
# 第二位
# 第三位

# 在 "第三位" 之後使用 AFTER 插入元素 "第四位"
127.0.0.1:6379> LINSERT mylist AFTER "第三位" "第四位"
# 4

127.0.0.1:6379> LRANGE mylist 0 -1
# 第一位
# 第二位
# 第三位
# 第四位

```

##  無序集合（set類型）操作

Redis中的Set類型是一個無序的、不重複的字串集合。 下面是Redis中Set類型的常見操作：

#### 1、向集合中添加元素

要向集合中添加元素，請使用SADD命令。 例如，要將值為「ulysses」的元素添加到名為「myset」的集合中，可以執行以下操作：

```r
127.0.0.1:6379> SADD myset ulysses
# 1 
127.0.0.1:6379> SADD myset ulysses
# 0
```

####  2、獲取集合中的元素數量

要獲取集合中的元素數量，請使用SCARD命令。 例如，要獲取名為「myset」的集合中的元素數量，可以執行以下操作：

```r
127.0.0.1:6379> SCARD myset
# 1
```

####  3、獲取集合中的所有元素

要獲取集合中的所有元素，請使用SMEMBERS命令。 例如，要獲取名為「myset」的集合中的所有元素，可以執行以下操作：

```r
127.0.0.1:6379> SMEMBERS myset
# ulysses
```

 這將返回一個包含所有元素的清單。

####  4、判斷元素是否在集合中存在

要判斷一個元素是否在集合中存在，請使用SISMEMBER命令。 例如，要判斷值為「ctt」的元素是否存在於名為「myset」的集合中，可以執行以下操作：

```r
127.0.0.1:6379> SISMEMBER myset ulysses
# 1
127.0.0.1:6379> SISMEMBER myset tony
# 0 
# 因為tony不在set裡面，返回0
```

 如果元素存在於集合中，則返回1; 否則返回0。

####  5、從集合中刪除元素

要從集合中刪除元素，請使用SREM命令。 例如，要刪除名為「myset」的集合中值為「ctt2」的元素，可以執行以下操作：
```r
127.0.0.1:6379> SREM myset ulysses
# 1 
```

####  6、求多個集合的交集、差集或並集

- 找出多個集合的交集，請使用SINTER命令。
- 找出多個集合的並集，請使用SUNION命令。
- 找出多個集合的差集，請使用SDIFF命令。 

先新增`SET`集合 :  set1、set2、set3 並添加以下內容
```r
127.0.0.1:6379> SADD set1 1 2 3 4 5
127.0.0.1:6379> SADD set2 3 4 5 6 7
127.0.0.1:6379> SADD set3 7 6 5 4 3 
```

##### 使用 SINTER 命令 

找出多個集合 `set1、set2、set3` 的交集
```r
127.0.0.1:6379> SINTER set1 set2 set3
# 3
# 4
# 5
```
交集數字 為 3、4、5 
##### 使用 SUNION 命令 

找出多個集合 `set1、set2、set3` 的並集 (三者之間沒有重複的數字)
```r
127.0.0.1:6379> SINTER set1 set2 set3
# 1
# 2 
# 3
# 4
# 5
# 6
# 7
```

##### 使用 SDIFF 命令 

用第一個`set1`集合內的減去其他集合 `set2、set3` 的差集 ( 其他集合內沒有的數字 )
```r
127.0.0.1:6379> SINTER set1 set2 set3
# 1
# 2
```

 這將返回一個包含所有集合的交集&並集元素的清單。
這些是Redis中Set類型的一些常見操作。 Set類型是一個非常有用的數據結構，可用於存儲和處理多個相關但不重複的元素。

####  7、求多個集合的交集、差集或並集 並儲存為另一個新集合

- 找出多個集合的交集，請使用 SINTERSTORE 命令。
- 找出多個集合的並集，請使用 SUNIONSTORE 命令。
- 找出多個集合的差集，請使用 SDIFFSTORE 命令。 

##### 使用 SINTERSTORE 命令 

```r
127.0.0.1:6379> SINTERSTORE result1 set1 set2 set3
# 3 
# 運算結果有符合有3個元素

127.0.0.1:6379> SMEMBERS result1 # 查看 result1 運算結果
# 3
# 4
# 5
```

##### 使用 SUNIONSTORE 命令 

```r
127.0.0.1:6379> SUNIONSTORE result2 set1 set2 set3
# 7
# 運算結果有符合有7個元素

127.0.0.1:6379> SMEMBERS result2 # 查看 result2 運算結果
# 1
# 2 
# 3
# 4
# 5
# 6
# 7
```

##### 使用 SDIFFSTORE 命令 

```r
127.0.0.1:6379> SDIFFSTORE result3 set1 set2 set3
# 2
# 運算結果有符合有2個元素

127.0.0.1:6379> SMEMBERS result3 # 查看 result3 運算結果
# 1
# 2
```


---

##  有序集合（ZSet類型）操作

Redis中的有序集合（Sorted Set，簡稱ZSet）是一個非常有用的數據結構，它類似於Set類型，但是每個元素都會關聯一個分數（score），且元素按照分數從**小到大進行排序**。 下面是Redis中ZSet類型的常見操作：

#### 1、向有序集合中添加元素

要向有序集合中添加元素，請使用ZADD命令。 例如，要將值為「A」的元素添加到名為「myzset」的有序集合中，且它的分數為100，可以執行以下操作：

先新增`ZSET`集合 :  A、B、C 、D 並添加以下內容
```r
127.0.0.1:6379> ZADD myzset 100 A 200 B 300 C 400 D
# 4 
```

####  2、獲取有序集合中的元素數量

要獲取有序集合中的元素數量，請使用ZCARD命令。 例如，要獲取名為「myzset」的有序集合中的元素數量，可以執行以下操作：

```r
127.0.0.1:6379> ZCARD myzset
# 4 
```

####  3、獲取有序集合中指定範圍內的元素

要獲取有序集合中指定範圍內的元素，請使用ZRANGE命令。 例如，要獲取名為「myzset」的有序集合中排名在1到3之間的元素，可以執行以下操作：

```r
127.0.0.1:6379> ZRANGE myzset 0 -1 
# A
# B
# C
# D
```

也可以加入參數，獲得元素中的分數 `COUNT`

```r
127.0.0.1:6379> ZRANGE myzset 0 -1 WITHSCORES
# A
# 100
# B
# 200
# C
# 300
# D
# 400
```

 這將返回一個包含指定元素的清單。
 

